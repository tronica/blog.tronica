language: minimal
services:
- docker
fast_finish: true
addons:
  ssh_known_hosts: blog.tronica.io
before_install:
- openssl aes-256-cbc -K $encrypted_3eb3d26b78a7_key -iv $encrypted_3eb3d26b78a7_iv
  -in deploy_key.enc -out deploy_key -d
- chmod 600 ./deploy_key
- eval "$(ssh-agent -s)"
- DISPLAY=":0.0" SSH_ASKPASS="/tmp/askpass" setsid ssh-add ./deploy_key </dev/null
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname
  -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
script:
- echo "$(docker-compose -v)"
- docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
- docker build . -t patrixr/tronica
- docker push patrixr/tronica
- echo "Pushing to $REMOTE_HOST"
- docker-compose -H "ssh://$REMOTE_HOST" down
- docker-compose -H "ssh://$REMOTE_HOST" pull
- docker-compose -H "ssh://$REMOTE_HOST" up -d
env:
  global:
  - DOCKER_COMPOSE_VERSION=1.24.1
  - secure: ZwJ9JNYC5pxETifo07X9xMCbmXwGcPpkcZ/Lj+TGZ/2R/uDTizP7oVO7VAbOxN3zoqDRrMnZlhFr0FweNpzr/DHeak3cKsTi6Nu9jz20nb+5NiZxeQz5FoUwwM1dbsvL/Hkc+CvMYvQ6QNVtll5/RV1Oa/GT7jlnTXhp5DZqgQC6hy7/0rQkZ1GmHAyaO8CISP4xUYiRPbCQA20l/97sB0QAO0mpdunXG+L9EgHr+knR8zUsmK1ieQGvIgzpVTZbznTwn9rZ8Hz4rrJt08bKyZCuSZyBrHlKscQR6OskXvvyRUjEJb5989C3hMViKlYdb8YxhccJgiVEdZw74Z4rQtD22a//wLpVcAYTAUF3Fz4CdebmWzgzTIZ2IspzOlJwU1taj2pKsokrs7slXfQuxSGRrhZi4FVzdFOeFN67g6EXOdnvoZi5UB+TsVBQdn2qSDdp3+4IuXbzCOwG7Vfm949jEcyK3j+LL1udVn8UFZD1Dh4RJKDzwAaTvuoTfGNIbJE+rTqqQaoh9tPZo6oMc4hoMFxnWmAPWYFLq1cBEzSo9UPB/TP2zC8AYRJD+ncizjAeWRflXB0IlSD6McwSsj7tPfWr28cEya4PVcPV5Q2Qhj6hdZsWVXoyOn/pfqV+DuR79BDWxJa3BoRCUy7Ef7jfraXkJi4enjXzCSdqkoE=
  - secure: dc9sjXHmHbYpZakzf9EkCScOllRNI4r1hlsp/esQCKBo/knHvYV5gbuzsHRN6suO2iVOYQAYxzIyyL5xaiQa2rYKYoBnw2exVcFJPPhmWxJ4uwFxRDId6MoXEErOjx+MOCz61nSn2wArxELlHdH3nr0v2i2saD5caTJ9tVkJTDA+divbDUdG0Z4NceUdpT/4kL1fZKSuAO7WxvEk7mgxrIPWtrWPWqjbHZcInbUVoEABMYcTQKEHSPzh9L9VKy6MtUqFJi2IjU4atDe7J8hdWGmziZstONKnvRO5fh3hJr96fXOgdvuvfQp+GQujYg34e9aUswG8nO7cujk4Yw5zRGLItgJxP8THQIkeNNgcnPhkHWsQCd2z/jWxvg5qWJkN9L2WDIjWfCFpMgBN7Bz4bsDgbuskSLFZ54UELCNJb68sL0HeEwdLxET39gl0tt4nM6IWSpi8QJOgt/paUe7x2ycWAIplfOWxgy7C3f2wHsJZYFO4wacrTbkzPRM1M+EkP0A1mHCsAn1P7VSzKOBkZE2h+S86eER+hTD7KUiRrv9+84WRVhINEPy4dCd5bKT9I4U6MglfXy99I8/AO2nD2MFO/4YJ2XbFa1aucCSetMDE6aOSyuu45J8Ak5uNO9axh+QNcbZq+F014O4qvn/nvU+Q4+QtCBOCBhD/jx5Czvo=
  - secure: n11ZEB/CJvAbnDd3oRU25M6W+Hd+wWHUCEiWUmYmyr7mtPKLjJoR41WF/k3ut4ypwXGe9fk85Y4QuKxP6JPgf3c11qThdaipEehliShr7YgE7o3z0YJQwzJNJhNxHTQFlgcuYyXaFrlM4A74EDcGXe9Olu6RH7u/IIAzCPd7iheGPeAIaHyjdEkgKtD3VmY3iOL0ihvijXAKryHVkbTRftJpq2rc4Wjkk2Jc4xO0EfRImKe4fZTFCWUntZTr4wL5vRBD1sxnSixz9/Qv/4YiSZnntmLPfvDznMOGlESCgmMcq5gsKJS+/uLq4zGv2Hr4mkG3si8XqBcVytSoHCy6WM80epYfOQxVAk3JA5uQ9NooQUSFAZpRnshlMu8MiBpSRJ5peLUKs+kxHdGVUnP06t7+uBYoFg7tLADnIGY5ORPbajic8Oj1gyMbikSuh/XuXQtXrBnW1hRlhtOeMY/IuAym3Fh1UvtlDdXAi6bhZbEg1F65p73sbk8JQqsDOX0khjwmTdwo3E3e/SyiwnOx3UfYM3WmCif8XAuOHHdzPu0rxRxkZKJlZ63iKm3Fg9Hzdj9gCRh1EJkfXOC8VzQC5WABDVcEVHpONlez7KDufgae5vBAKR6QvLveA1Uaf+1Ivo4YliWWFr3jhmSyJhxRfc9okcjzWxjNYxbxHyX5VW8=
  - secure: H/qnxr6EmHv9PcH5MgcrtOsCAwk5TflpWeRi+7coeHE/zQ/O/VmWNaAQSSYXfmSkA0i9tXhHbo+oYD7aJsq/Hky5p3/CKA0MVZG9HWAqQV2YOvIS8inLs8g4E/Ou4nQ+D/U0TA+clwQ6IJ9Imk3j2aMbhibsN9ISnZPzDQhs/bvVOv/8i0IiLqupSZv+6EVrFT+9IS0R13uZzEFgyAXzb+felcki9QgXDdmjApsL0pnS4bkiPJf/IKj7tbXHg+A0wsRENarexWeQLo/A24sWZFEXX0+LmCf6flMHfVaKBDEYPzYmxeT5KfETm6T4yAiHcQYsQL699Za0fBwIJk1FX02tY9lISOI1N8fw7I2+/wTcwag7xZKPXYaHApweLJ2ZPvtWs15izTviCB5Ss1wtXn2eNq+2pacZTWQnDaPUDopGcHWY3SYhnt4t4aQEaSiFd2cI4fe3Ic5q1icgf9Diw+P2n43OVkfATSwayupjnCF4+KfCB38tYc2+F69SYORWykzXItLROkma/GDJAPeCNcAyq9BetLy7bY+YQ0Ku51SmcwEWRydnIUen/RmIo+/IAmd5cGvObwZOoRCnHeHMm8CL35vOWqSSFRqhXLidt3BiUZF+nQ33CCiXXh4C5dLi091sR+Y99W+mXGlN8cso34LCavH5rLwjSes7y89Nqx0=
  - secure: MDzR3oUrBRLodCVN7Idc8xdHKOYK3z2NzvxNwP+wBvq3tnc+h678G9UCgdJIQwJyA8IRK8LamRxJT9WKKdvfy5Eql5VM9jq/99qR3SDFfr/pQEPzo5ZGCF/aGd4lj7MLnCIGAgDuW+AsM6f4myx8I6zykElokVb8F472aKIzKYiZjGtFQme63YX89bgVRPdv7JPlLf99p50BRYL06NHpEw2nLknfFYgXv8XtL1urvDtLHaSBUAJgbNGeSaZKz13r7U2iQJQvbylQsUA60SxcmVOj8Iz7NDwMYhN63u4LCb/AQX2tRJMSmgdEKsnc7QwLDyXZFAp+Nx39GKSGi6wIcDQo0CKk8VdpT0h0uySTtdacRO2BHS2zCI4+Gwfqgi8qjBTb/LAoghcENlejjXMu8skRdKJ/0HKguKyXKPiLuv9Xrl6I/uQoleiD8u8/atQCAPkP/MLmK0Ke7J2LsOVtvEtv1HGcJef3uYNb8if1wd84/ARjBUVEAYhn2FZ3LDvtA4juzZy1M7pKcYslixscvS+6w0YjroHT89yB0FN1pOAiPtniOcWSrq23PVLAk2+z2n6m+kEV8vr0yFDo60S2cmKYpD6kT3wOaTT87CfA7puLdrB/hUn55Tnvt7tL3KCNCqEby+dPjuQKc6ueKfCa4xRzRUZFnTfGnUgXECC+DYg=
  - secure: BALlKr9Hv9uzwnX76sMdIXo9v0tklTDgY46R/hyKEBo/iDoCIyIrAlOvBwmAEUW7hfnx0GcjvorRRpd7qu/6TrxsQ0wlDJP8TlUXrYmqqEdUUQNzel2Reh4ldxPJF1x2AHrDKxxtvHgOoxwoGoDsI2LDEzw525BDuxHffb9uVKXKeJAj0qOGKVYlJVfDODcDA8DINNGxvM/SMS/v1+oyevKop1Kvnc5AkoGWXPsut4Fm3TrsuQM8BOpG+nbNVXpRGB9y9Oz2JmoCBUG0CQ8S5OIE0TniqrAnltoi2vySB8P8L/kcfnzZ5Jje6hEVpkL6sX70yj7DhzuKpu2+PlcltyWO7CXdYQ5ZWlmBBsfF2jCuth9FuOfx/gtJugoabmzR2CiPsdpFgqYePgzPExhci4YPWv8quknrrk3xiZBFAfMZ84lsLpHrB3zet5M4s5/eGf6fvJZ9h9NpVCQ5lyzev2K1Zjpc1/5QyGVxgo6K9LbHHwhVDgDb5e+q2ZMHWoBYAdlyDgeIZQD7yX9sb058Ni7AJo367Dl5hb7DF5JO8BCAad2ItOGxcedWGezWsR2CPTjQmSSHbNr7KC6U/fQ86Ki4f99k2C1vioFSZSusPEZ15G4D2DWwSVzV8Fb4W7EGPCEKSPLMKCUJknAq5cI2OjGWs6aEKm2DxC+0swMVUQc=
  - secure: XCOuHn6y/tHLPT/Hi5521mIEXRqARPq4wwUlJ0W7zY3OG1gT8zJ3HJVnKh4t+mMnz1u8fY2cpvqRSM/sPqswjM8t1jbCykUWjQXS8fmeJOpQ8bOIOb9maP7SOYwIzd17OPqWbIaHb4yDkR2F3/av8ScWogwySV2kf1fzF/x1E1mztLfg3fRuAtgVqgzWEEG15IU8VzmPAQiKl3oMHkrY3QGeueCfu13aJ5djCtkPwtA2DyrDQGCQVi6pBsS4ZyWO92V860njRdmW+3LD08876o0P9A8UqakO1RfcfPpigXINSmjgw66RfI50sLvRn6YtOmf2qVjhayi7e03KaAbo2Yo87mYEkFG1qROy9UGUW4QNPM9MeoKf1JZ+ysxLf93Es0yyFYx0wJ1/QVwpUPNFungx8lHu7HbGQaY0Vj6WeJl8a4gUgNarly5mUi5vBi7YyIHaz63MpvjWV43RHG49QC9dN+eB4/z5N/YcGhWjee5jF56ZRf8rIUgtHM8wNPBhmhfipDc8mCvMvvgp7WzueSo5IFUxWbJi9MF1tqUtn2et5Dxf7DT6jhB8JAcBfzDmAgZaymBM7ZmsGao8vyU5bFxJ2E6c2BHtiOLsPv+fPxpJJvuFnISN1n0WMK9I3VXVURggR64DPUnSxD9SG6tMXITRI08z8PhkucZk0caW644=
  - secure: g6iZZVKzve55EYe2JLKGQ7PzhPuxzaEFF08se4AezFMDfbOp611RfQSFY6tssPeu6TT6iv0ImQ6i7EZw0ZZqYj//pwXfuIqDrR/NBsit9t4xeIFAmZ+9QE6y+4FeAGh4HF0UjgStfpzfvaKLoReKJY0GHPDbvqjjstPx7tJ0fc7zn+juucb/Z0d5UL/DSBwBPbGsPGKtw3SJQunIfVSenxftesWlo592SM0mzrVDGNweh9iKvyOCpp0ogNPFcDJfYeB00hVza44sjdEWbngSeNx8eZyHlxKDcVTn/sX+8ebRTkoWChjpvFXk4FsfuoWtH4ZNNhrdvCXQxodCDwOfb4ngwHWIbnjav8rSVNUH+7Vz+EktfJlYk5pSoMYaribT/I+Rph6x9dqMdu8GA6NxyRQIBjki0+EWTSyRXBNuzA/dAzK6/kQrVcmWxG3d7dnfdxCoeWOjnopTdnKLXxASRU0UeyTO/vmLhen/d2AhIIRFn9Od/qfhgfo7ct+l8uZf65XVA9ZLTvleMQg6dstaLNvvI0L8wYpH69TsMvrc2tSeFBPhqgQ8tbPgZXLXvpJGZDDY5EarVV3jO262umBUdxg4il9BpMqVVIyKFwqUN7Q2puSGH4u4mY2OAf8ClqvwY/bz4SXitDvU/99NnSOjn4cCoN4J4JDTwwtJmI5I+E4=
  - secure: Gz3KQ5HSTOLN6TrHOtCWz7fnhN0Ld6vjTtDNfgyrUW6LjKfixCIKp7iQ5y3us+j+SCLZwGxYGQzg00YrB/9254lBaxssbW4mRc54tj6zhSX9yQcyyaqWtFYDQWMJQiK8BRXFrE9q/DrqWWY2+v70cpsaCrpjc6x6Pgnk5sONpXk3XNVQ961KFPbZqyvJt247hUo1goLEmyAHpVBjM23h5Z1ndFV/ShkBYLXPYoWLCqOOXRCKgWgUCV0jGd5PtM5w65Mm4DCQO7dGAh+I28Sa3opgd6i96FInzpW9Sqj1Bl0b9eGOnVrpzSLg1ys9x8BHLfJaD5ETy9DYGe0rKnma56CKlUEDEdl0h8aT7yOYNyIwAnCjhVMR1bYm73mDah9TrDW3hTTmQqWPNLbuvCKsraNkIckF2XTRyfxdOHbpgZd810SepMrgbYWb5KfaF+Qw7NPYjr9VZHIzHTlJCt5F3JcaUfGaY0lZ7wsXNU/uVjSIP5IgDYKYUwYv0XCz1O0i0YtXqyfX/vZlOkhJNHKKUvSCTpDiIBk9v1mqo7ak3wq5jO93iqh2YNI0NanuPC+dDqAIEDrqSVR1SkApcdzzqd+uLHRdP8rKWK9oUHOLezxSzROYJZqzJkMbdu7ANMs3UWumQIt2aekTqn3uJAOtHNVkw7RLKYXtantBx7W/tgA=
  - secure: j0FTJocD6Qt/FA81FK9Pi57pgWJ4FjzPRsteWUmO3FeUWiRp/VEL1xOfIaW+5HfRlxbDneutTAycCw8RPkjFIk/dfP/Q2+b1CO7BfmcRLlpbPlKn7vyABTlzXTapvItEFJKttQc3i0ZxfipMiVo7Yl0W+UwHJxvqmzePuAyHgn331vq18YI7q3zKArs1lL6ubFksgjnMkwD8HUndT4Of6pYPPFnZnvzU6hq04RDBUODzoqDLKTrDaJ7mHgK9VohZiFY9PWU4vDmjIrYVBDEJG6OVYKwu2V4yyIuFs87qSSB9+RHNRTrbZ0OiUkNH8JoME7L3aD4ubyIWay6Bqz4j45A9g1KW7wHauRQkk8Xk+SOG47tRYQ+BQo/xhFtplpDKTr0scKCvTP/t0twzFev+B4imh1VSMfnz7vt6EZX7d9++rLyPA99t5/Hfy0qRqnJbkntMepU+nhla7bSc63QhDHqe5Gl3SgIdjhCd4Sw5VxPJL8h14t/YMW1QiYRPs211e/wVY7d4HeZDzEUefxb+T9jSBiits+ECQvmpyJsXNi0UPLjdJEm5bwRqmL4/6Yk4xgFAcSpt3D4coFwS6lXgTOftiYjGADS4a6+ymoSm8aK3YmIKCUdgyaC9oRffq0IHNARkx3Xe1F7MR3hh7GQktgDhgDx+LiCSL0EG7MBMwTA=
  - secure: TC3JU+C/vMQSNmKkgIZvBVByNLgDqDX4WbYv6CEtz3mhJkUJqnx/UA+VmpguyHR2vu4KQIBoEWo/+uTSOExL4MyNxUeg2uPKMik4xZXFa+yOVytNH4OhF2Zzby0esWpOE86ilqne9XgXLrGcxOGthH29QIwlatm6cteN+Gu5ArFO4D2gBBmhkBE+zPvW0l9zcvegU1RTik69zaekPbNoB8mRmgt0iGrwyXXKya5tH7vafnuexDqre3RGxVLmNvNPmditBPG+CL3h5KiILOiv0uEvg04wJneOcEejJhWAnGnSKw3C8jMROq2DX4MxWf4PS1DIiCfcYWUBOHKlzcjGFUJIHtSnFYb1vsyKtuhlagQIJQbNO5Li2W6i9rIJRlsww6r+sLCrbMqKBHO9l2NMw/AqOcKA4CBIbFswMLvec7Sm0OmwRD7QhbXdbKPCiq5exbUcVWg78xWQmRNea4LzW/cERlc+11z7uX5hzQqbuwOP8uWOj9yr4deQWc2UkjvZ5c5GrrGNpHU5QwS/3Tty4p6+226e4ZwTqKrEvZKTjMZUmTtvSbfkhMaeDmIleJAibnYBbKA9eQUgp+HYnMmMp4PTK7WQVvNlZDPLHTcLAfJywcGSMvPl7lmsaomGja2nprqH8K3YdLOodGYMoRCaO8F8H4zoHRr3SWrjHZAMB9U=
